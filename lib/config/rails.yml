---
exclude_paths:
  - db/migrate/*

rules:
  - skip: true
    names:
      - ClassMethods # ActiveSupport::Concern
      - process_action # ActiveSupport::LogSubscriber
      - validate_each # ActiveModel::EachValidator
      - format_message # ActiveSupport::Logger
      - ssl_configured? # ApplicationController
  - skip: true
    names:
      has_suffix: Helper
    path: app/helpers
  - names:
      - after_initialize
      - after_find
      - after_touch
      - before_validation
      - after_validation
      - before_save
      - around_save
      - after_save
      - before_create
      - around_create
      - after_create
      - before_update
      - around_update
      - after_update
      - before_destroy
      - around_destroy
      - after_destroy
      - after_commit
      - after_rollback
      - after_create_commit
      - after_update_commit
      - after_destroy_commit
      - after_save_commit
    calls:
      arguments:
        - 1
        - if
        - unless
  - name:
      - after_action
      - append_after_action
      - append_around_action
      - append_before_action
      - around_action
      - before_action
      - prepend_after_action
      - prepend_around_action
      - prepend_before_action
      - skip_before_action
      - skip_after_action
      - skip_around_action
      - validates_associated
    calls:
      - arguments:
          - '*'
          - if
          - unless
  - name:
      - delete
      - get
      - patch
      - post
      - put
    calls:
      - argument: 1
  - name: validates
    calls:
      - arguments:
          - '*'
          - 'in'
          - inclusion
          - scope
          - if
          - unless
      - keys: '*'
        activesupport: camelize
        add_suffix: Validator
  - names:
      - validate
      - validate_associated
    calls:
      - arguments: ['*', if, unless]
  - name:
    - check_box
    - date_select
    - datetime_select
    - file_field
    - hidden_field
    - label
    - radio_button
    - select
    - time_select
    - time_zone_select
    - color_field
    - date_field
    - datetime_field
    - dattime_local_field
    - email_field
    - month_field
    - number_field
    - password_field
    - phone_field
    - range_field
    - search_field
    - telephone_field
    - text_area
    - text_field
    - time_field
    - url_field
    - week_field
    calls:
      - arguments: [1,2] # 1: with a receiver, 2: with no receiver
      - arguments: [1,2]
        add_suffix: '='
  - name: fields_for
    calls:
      argument: 1
      add_suffix: _attributes
  - name: options_from_collection_for_select
    calls:
      - arguments: [2,3]
  - name:
      - collection_select
      - collection_check_boxes
      - collection_radio_buttons
    calls:
      - argument: 2
        add_suffix: '='
      - arguments: [4,5]
  - name: grouped_collection_select
    calls:
      - argument: 2
        add_suffix: '='
      - arguments: [4,5,6,7]
  - name: option_groups_from_collection_for_select
    calls:
      - arguments: [1,2,3,4]
  - name: scope
    path: app/models/*
    defines:
      argument: 1 # ar
  - name: scope
    path: config/routes*
    calls:
      argument: module # routes
      activesupport: camelize
  - name: namespace
    calls:
      - argument: 1
        activesupport: camelize
  - name:
      - attribute
      - alias_attribute
    path: app/models/*
    defines_group:
      - argument: 1
      - argument: 1
        add_suffix: '?'
      - argument: 1
        add_suffix: '='
  - name: alias_attribute
    calls:
      - argument: 2
      - argument: 2
        add_suffix: '?'
      - argument: 2
        add_suffix: '='
  - name:
    - has_one
    - belongs_to
    calls:
      argument: 1
      activesupport: camelize
      unless:
        keyword: class_name
  - name:
    - has_many
    - has_and_belongs_to_many
    calls:
      argument: 1
      activesupport: [singularize, camelize]
      unless:
        keyword: class_name
  - name:
    - has_many
    - has_one
    - has_and_belongs_to_many
    calls:
      argument: as
  - name:
      - has_one
      - has_many
      - belongs_to
      - has_and_belongs_to_many
    defines_group:
      - argument: 1
      - argument: 1
        add_suffix: '='
    calls:
      - argument:
          - through
          - class_name
          - inverse_of
      - argument: 1
        if:
          keyword: dependent
      - argument: 1
        if:
          keyword: inverse_of
  - name:
      - rescue_from
    calls:
      - argument: with
  - name:
      - match
      - delete
      - get
      - patch
      - post
      - put
    calls:
      - arguments: [1, action]
      - argument: '**'
        delete_before: '#'
      - argument: '**'
        delete_after: '#'
        add_suffix: Controller
        activesupport: camelize
  - name: delegate
    defines:
      - argument: '*'
        if:
          keyword:
            prefix: true
        add_prefix:
          from_keyword: to
          joiner: '_'
      - argument: '*'
        if:
          keyword: prefix
        unless:
          keyword:
            prefix: true
        add_prefix:
          from_keyword: prefix
          joiner: '_'
    calls:
      - argument: to
      - argument: '*'
        if:
          keyword: prefix
  - name:
      - resource
      - resources
    calls:
      - argument: only
      - argument: controller
        add_suffix: Controller
        activesupport: camelize
  - name:
      - resources
      - controller
      - namespace
    calls:
      - argument: 1
        add_suffix: Controller
        activesupport: camelize
  - name: accepts_nested_attributes_for
    defines_group:
      - argument: '*'
        add_suffix: _attributes
      - argument: '*'
        add_suffix: _attributes=
    calls:
      argument: reject_if
  - name: resource
    calls:
      - argument: 1
        add_suffix: Controller
        activesupport:
          - pluralize
          - camelize
  - name:
    - new
    - create
    - create!
    - update
    - update!
    - assign_attributes
    calls:
      keys: '*'
      add_suffix: '='
  - name: permit
    calls:
      arguments: ['*', '**']
      keys: '*'
      add_suffix: "="
  - name: layout
    calls:
      argument: 1
  - name:
      - includes
      - preload
      - eager_load
      - joins
      - left_joins
      - left_outer_joins
    calls:
      arguments: ['*', '**']
      keys: '*'
  - name:
      - string
      - text
      - integer
      - bigint
      - float
      - decimal
      - numeric
      - datetime
      - time
      - date
      - binary
      - boolean
    path: config/db_schema.rb
    calls:
      - argument: 1
      - argument: 1
        add_suffix: '='
      - argument: 1
        add_suffix: '?'
  - name:
      - cattr_accessor
      - mattr_accessor
    defines:
      - argument: '*'
        add_suffix: '='
      - argument: '*'
    calls:
      - argument: '*'
        add_prefix: '@'
  - name:
      - cattr_reader
      - mattr_reader
    defines:
      - argument: '*'
    calls:
      - argument: '*'
        add_prefix: '@'
  - name:
      - cattr_writer
      - mattr_writer
    defines:
      - argument: '*'
        add_suffix: '='

  - name:
    - thread_cattr_accessor
    - thread_mattr_accessor
    defines:
      - argument: '*'
      - argument: '*'
        add_suffix: '='
  - name:
    - thread_cattr_reader
    - thread_mattr_reader
    defines:
      - argument: '*'
  - name:
    - thread_cattr_writer
    - thread_mattr_writer
    defines:
      - argument: '*'
        add_suffix: '='
  - name: delegate_missing_to
    calls:
      - argument: 1
