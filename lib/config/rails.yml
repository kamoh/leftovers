---
exclude_paths:
  - db/migrate/*

rules:
  - skip: true
    name:
      - ClassMethods # ActiveSupport::Concern
      - process_action # ActiveSupport::LogSubscriber
      - validate_each # ActiveModel::EachValidator
      - format_message # ActiveSupport::Logger
      - ssl_configured? # ApplicationController
  - skip: true
    name:
      suffix: Helper
    path: app/helpers
  - name:
      - after_initialize
      - after_find
      - after_touch
      - before_validation
      - after_validation
      - before_save
      - around_save
      - after_save
      - before_create
      - around_create
      - after_create
      - before_update
      - around_update
      - after_update
      - before_destroy
      - around_destroy
      - after_destroy
      - after_commit
      - after_rollback
      - after_create_commit
      - after_update_commit
      - after_destroy_commit
      - after_save_commit
      - with_options
    caller:
      - position: 1
      - keyword:
          - if
          - unless
  - name:
      - after_action
      - append_after_action
      - append_around_action
      - append_before_action
      - around_action
      - before_action
      - prepend_after_action
      - prepend_around_action
      - prepend_before_action
      - skip_before_action
      - skip_after_action
      - skip_around_action
      - validates_associated
    caller:
      - position: '*'
      - keyword:
          - if
          - unless
  - name:
      - delete
      - get
      - patch
      - post
      - put
    caller:
      - position: 1
  - name: validates
    caller:
      - position: '*'
      - keyword:
          - 'in'
          - inclusion
          - scope
      - key: true
        suffix: Validator
        activesupport: camelize
      - keyword:
          - if
          - unless
  - name:
      - validate
      - validate_associated
    caller:
      - position: '*'
      - keyword: [if, unless]
  - name:
    - check_box
    - date_select
    - datetime_select
    - file_field
    - hidden_field
    - label
    - radio_button
    - select
    - time_select
    - time_zone_select
    - color_field
    - date_field
    - datetime_field
    - dattime_local_field
    - email_field
    - month_field
    - number_field
    - password_field
    - phone_field
    - range_field
    - search_field
    - telephone_field
    - text_area
    - text_field
    - time_field
    - url_field
    - week_field
    caller:
      - position: [1,2] # 1: with a receiver, 2: with no receiver
        transforms:
          - true
          - suffix: '='
  - name: fields_for
    caller:
      position: 1
      suffix: _attributes
  - name: options_from_collection_for_select
    caller:
      - position: [2,3]
  - name:
      - collection_select
      - collection_check_boxes
      - collection_radio_buttons
    caller:
      - position: 2
        suffix: '='
      - position: [4,5]
  - name: grouped_collection_select
    caller:
      - position: 2
        suffix: '='
      - position: [4,5,6,7]
  - name: option_groups_from_collection_for_select
    caller:
      - position: [1,2,3,4]
  - name: scope
    path: app/models/*
    definer:
      position: 1 # ar
  - name: scope
    path: config/routes*
    caller:
      keyword: module # routes
      activesupport: camelize
  - name: namespace
    caller:
      - position: 1
        activesupport: camelize
  - name: attribute
    path: app/models/*
    definer:
      - position: 1
        transforms:
          - true
          - suffix: '?'
          - suffix: '='
  - name: alias_attribute
    path: app/models/*
    definer:
      - position: 1
        transforms:
          - true
          - suffix: '?'
          - suffix: '='
    caller:
      - position: 2
        transforms:
          - true
          - suffix: '?'
          - suffix: '='
  - name:
    - has_one
    - belongs_to
    caller:
      position: 1
      activesupport: camelize
      unless:
        keyword: class_name
  - name:
    - has_many
    - has_and_belongs_to_many
    caller:
      position: 1
      activesupport: [singularize, camelize]
      unless:
        keyword: class_name
  - name:
    - has_many
    - has_one
    - has_and_belongs_to_many
    caller:
      keyword: as
  - name:
      - has_one
      - has_many
      - belongs_to
      - has_and_belongs_to_many
    definer:
      - position: 1
        transforms:
          - true
          - suffix: '='
    caller:
      - keyword: through
      - keyword: class_name
      - keyword: inverse_of
      - position: 1
        if:
          keyword: dependent
      - position: 1
        if:
          keyword: inverse_of
  - name:
      - rescue_from
    caller:
      - keyword: with
  - name:
      - match
      - delete
      - get
      - patch
      - post
      - put
    caller:
      - position: 1
      - keyword: '*'
        after: '#'
      - keyword: '*'
        before: '#'
        suffix: Controller
        activesupport: camelize
      - keyword: action
  - name: delegate
    definer:
      - position: '*'
        if:
          keyword:
            prefix: true
        prefix:
          from_keyword: to
          joiner: '_'
      - position: '*'
        if:
          keyword: prefix
        unless:
          keyword:
            prefix: true
        prefix:
          from_keyword: prefix
          joiner: '_'
    caller:
      - keyword: to
      - position: '*'
        if:
          keyword: prefix
  - name:
      - resource
      - resources
    caller:
      - keyword: only
      - keyword: controller
        suffix: Controller
        activesupport: camelize
  - name:
      - resources
      - controller
      - namespace
    caller:
      - position: 1
        suffix: Controller
        activesupport: camelize
  - name: accepts_nested_attributes_for
    definer:
      position: '*'
      transforms:
        - suffix: _attributes
        - suffix: _attributes=
    caller:
      keyword: reject_if
  - name: resource
    caller:
      - position: 1
        suffix: Controller
        activesupport:
          - pluralize
          - camelize
  - name:
    - new
    - create
    - create!
    - update
    - update!
    - assign_attributes
    caller:
      key: true
      suffix: '='
  - name: permit
    caller:
      position: '*'
      keyword: '*'
      key: true
      suffix: "="
  - name: layout
    caller:
      position: 1
  - name:
      - includes
      - preload
      - eager_load
      - joins
      - left_joins
      - left_outer_joins
    caller:
      position: '*'
      keyword: '*'
      key: true
  - name:
      - string
      - text
      - integer
      - bigint
      - float
      - decimal
      - numeric
      - datetime
      - time
      - date
      - binary
      - boolean
    path: config/db_schema.rb
    caller:
      position: 1
      transforms:
        - true
        - suffix: '='
        - suffix: '?'
  - name:
      - cattr_accessor
      - mattr_accessor
    definer:
      - position: '*'
        suffix: '='
      - position: '*'
    caller:
      - position: '*'
        prefix: '@'
  - name:
      - cattr_reader
      - mattr_reader
    definer:
      - position: '*'
    caller:
      - position: '*'
        prefix: '@'
  - name:
      - cattr_writer
      - mattr_writer
    definer:
      - position: '*'
        suffix: '='

  - name:
    - thread_cattr_accessor
    - thread_mattr_accessor
    definer:
      - position: '*'
      - position: '*'
        suffix: '='
  - name:
    - thread_cattr_reader
    - thread_mattr_reader
    definer:
      - position: '*'
  - name:
    - thread_cattr_writer
    - thread_mattr_writer
    definer:
      - position: '*'
        suffix: '='
  - name: delegate_missing_to
    caller:
      - position: 1
