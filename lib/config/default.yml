---
includes:
  - '*.rb'
  - '*.rake'
  - '*.ru'
  - Rakefile
  - Gemfile
  - Capfile
  - '*.haml'
  - '*.erb'
  - '*.builder'
  - '*.jbuilder'
  - '*.gemspec'

allowed:
  - initialize # called by new
  - inspect # called by repl
  - respond_to_missing? # called by respond_to?
  - method_missing # called by method dispatch
  - to_s # called by #{}
  - to_ary
  - to_str
  - <=> # called by Comparable
  - each # called by Enumerable
  - marshal_dump # called by Marshal.dump
  - marshal_load # called by Marshal.load
  - _dump # called by Marshal.dump
  - _load # called by Marshal.load

tests:
  - /tests/
  - /test/

rules:
  - method:
      - send
      - public_send
      - __send__
      - method
      - respond_to?
      - instance_method
    caller:
      position: 1
  - method: attr_reader
    definer:
      position: '*'
    caller:
      position: '*'
      prefix: '@'
  - method: attr_writer
    definer:
      position: '*'
      suffix: '='
  - method: attr_accessor
    definer:
      - suffix: '='
        position: '*'
      - position: '*'
    caller:
      position: '*'
      prefix: '@'
  - method: define_method
    definer:
      position: 1
  - method: alias_method
    definer:
      position: 1
    caller:
      position: 2
  - method:
      - instance_variable_get
      - class_variable_set
    caller:
      position: 1
  - method:
      - instance_variable_set
      - class_variable_set
    definer:
      position: 1
